/**
 * 
 * 
 */

'use strict';

module.exports = {
	watch: watch
}


var PATH = require('path');
var FS	 = require('fs');
var cwd = process.cwd();


var bjsTransport = require(PATH.join(__dirname, 'bjs-command/grunt-task/lib/cmd-transport.js'));


function watch(conf, which){
	var watcher = require(PATH.join(__dirname, 'bjs-watch/lib/watch.js'));
	if(which){
		// inotify
	}else{
		// chokidar
		watcher.watchA(PATH.join(cwd, conf.src), function(type, path){
			if(FS.statSync(path).isFile()){
				if(/\.css$|\.js$/.test(path)){
					bjsTransport([path], PATH.join(cwd, conf.src), PATH.join(cwd, conf.dest))
				}
			}
		});
	}
}