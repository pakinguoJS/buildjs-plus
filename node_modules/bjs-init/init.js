/**
 * @description 初始化项目目录结构，以生成bjs.config.js为唯一校验，若存在该配置文件，则不执行初始脚本
 *
 * @author pakinguo
 *
 */

function init(ctype) {
	var FS = require('fs');
	var PATH = require('path');
	var colors = require('colors');
	var UTIL = require('bjs-util');
	var JSONNICE = require('json-nice');

	var cwd = process.cwd();
	var confPath = PATH.join(cwd, 'bjs.conf.js');

	// record
	UTIL.timer.start();

	if (FS.existsSync(confPath)) {
		process.stdout.write('bjs.conf.js'.green + ' is already existed!\n');
		return;
	}

	switch (ctype) {
		case 'cmd': initCmd();break;
		case 'amd': break;
		case 'none': break;
		default: break;
	}


	function initCmd(){
		var conf = require(PATH.join(__dirname, 'lib/init-cmd.js'));
		FS.writeFileSync(confPath, JSONNICE(conf), 'utf8');
	}

	function formatJSON(obj){
		return JSON.stringify(obj).replace(/\{/g, '{\n\t').replace(/,/g, ',\n\t').replace(/\}/g, '}\n');
	}
}

module.exports = init;